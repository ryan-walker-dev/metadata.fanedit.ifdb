<?xml version="1.0" encoding="utf-8"?>
<scraper framework="1.1" date="2015-01-30" content="movies">

  <CreateSearchUrl clearbuffers="no" dest="3">
    <RegExp input="$$1" output="&lt;url&gt;https://fanedit.org/fanedit-search/search-results/?query=all&scope=title&keywords=\1&order=alpha&lt;/url&gt;" dest="3">
      <expression noclean="1" />
    </RegExp>
  </CreateSearchUrl>

  <NfoUrl dest="3">
    <RegExp input="$$1" output="\1" dest="3">
      <expression></expression>
    </RegExp>
  </NfoUrl>

  <GetSearchResults dest="8">
    <RegExp input="$$5" output="&lt;results&gt;\1&lt;/results&gt;" dest="8">

      <!--Normal Search-->
      <RegExp input="$$1" output="&lt;entity&gt;&lt;title&gt;\2&lt;/title&gt;&lt;url&gt;https:\/\/fanedit.org\1&lt;/url&gt;&lt;/entity&gt;" dest="5">
        <expression noclean="1" repeat="yes" >&lt;a href=&quot;(\/[^&quot;\/]*\/)&quot;[^&gt;]*&gt;([^&lt;]+)&lt;\/a&gt;</expression>
      </RegExp>

      <!--For if we get a direct match and redirected straight to movie page-->
      <RegExp input="$$3" output="&lt;entity&gt;\1&lt;/entity&gt;" dest="5+">

        <!--URL from current page-->
        <RegExp input="$$1" output="&lt;url&gt;\1&lt;/url&gt;" dest="3">
          <expression noclean="1">&lt;link rel=&quot;canonical&quot; href=&quot;([^&quot;]+)&quot;</expression>
        </RegExp>

        <!--Title-->
        <RegExp input="$$1" output="&lt;title&gt;\1&lt;/title&gt;" dest="3+">
          <expression noclean="1">&lt;h1[^&gt;]*&gt;([^&lt;]+)&lt;\/h1&gt;</expression>
        </RegExp>

        <expression noclean="1" />
      </RegExp>

      <expression noclean="1" />
    </RegExp>
  </GetSearchResults>

  <GetDetails dest="7">
    <RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="7">

      <!--Plot-->
      <RegExp input="$$1" output="&lt;plot&gt;\1&lt;/plot&gt;" dest="2">
        <expression fixchars="1" trim="1">&lt;section[^&gt;]*&gt;[\s]*&lt;h2[^&gt;]*&gt;Synopsis&lt;\/h2&gt;[\s]*&lt;p[^&gt;]*&gt;([^&lt;]*)&lt;\/p&gt;</expression>
      </RegExp>

      <!--Genres-->
      <RegExp input="$$5" output="&lt;genre&gt;\1&lt;/genre&gt;" dest="2+">
        <RegExp input="$$1" output="\1" dest="5">
          <expression noclean="1">&lt;li&gt;&lt;strong&gt;Genre:&lt;\/strong&gt;[\s]*([^&lt;]+)&lt;\/li&gt;</expression>
        </RegExp>
        <expression noclean="1" repeat="yes">([A-Za-z\s]+)(?:,|$)</expression>
      </RegExp>

      <!--Genre-->
      <RegExp input="$$1" output="&lt;genre&gt;\1&lt;/genre&gt;" dest="2+">
        <expression noclean="1">&lt;li&gt;&lt;strong&gt;Genre:&lt;\/strong&gt;[\s]*([^&lt;,]+)</expression>
      </RegExp>

      <!--Votes-->
      <RegExp input="$$1" output="&lt;votes&gt;\1&lt;/votes&gt;" dest="2+">
        <expression noclean="1">&lt;span[^&gt;]*&gt;\(([0-9]+)[\s]*votes?\)&lt;\/span&gt;</expression>
      </RegExp>

      <!--Rating-->
      <RegExp input="$$1" output="&lt;rating&gt;\1&lt;/rating&gt;" dest="2+">
        <expression noclean="1">&lt;span[^&gt;]*&gt;Rating:[\s]*([\d.]+)[\s]*\/[\s]*10</expression>
      </RegExp>

      <!--Thumbnail-->
      <RegExp input="$$1" output="&lt;thumb&gt;\1&lt;/thumb&gt;" dest="2+">
        <expression noclean="1">&lt;img[^&gt;]*class=&quot;[^&quot;]*wp-post-image[^&quot;]*&quot;[^&gt;]*src=&quot;([^&quot;]+)&quot;</expression>
      </RegExp>

      <!--Tagline-->
      <RegExp input="$$1" output="&lt;tagline&gt;\1&lt;/tagline&gt;" dest="2+">
        <expression fixchars="1" trim="1">&lt;li&gt;&lt;strong&gt;Tagline:&lt;\/strong&gt;[\s]*([^&lt;]+)&lt;\/li&gt;</expression>
      </RegExp>

      <!--Directors-->
      <RegExp input="$$5" output="&lt;director&gt;\1&lt;/director&gt;" dest="2+">
        <RegExp input="$$1" output="\1" dest="5">
          <expression noclean="1">&lt;li&gt;&lt;strong&gt;Faneditor Name:&lt;\/strong&gt;[\s]*([^&lt;]+)&lt;\/li&gt;</expression>
        </RegExp>
        <expression noclean="1" repeat="yes">([A-Za-z0-9\s\-&apos;]+)(?:,|$)</expression>
      </RegExp>

      <!--Director-->
      <RegExp input="$$1" output="&lt;director&gt;\1&lt;/director&gt;" dest="2+">
        <expression noclean="1">&lt;li&gt;&lt;strong&gt;Faneditor Name:&lt;\/strong&gt;[\s]*([^&lt;,]+)</expression>
      </RegExp>

      <!--Year-->
      <RegExp input="$$1" output="&lt;year&gt;\1&lt;/year&gt;" dest="2+">
        <expression noclean="1">&lt;li&gt;&lt;strong&gt;Fanedit Release Date:&lt;\/strong&gt;[\s]*[A-Za-z]*[\s]*([0-9]{4})</expression>
      </RegExp>

      <!--Title-->
      <RegExp input="$$1" output="&lt;title&gt;\1&lt;/title&gt;" dest="2+">
        <expression noclean="1">&lt;h1[^&gt;]*&gt;([^&lt;]+)&lt;\/h1&gt;</expression>
      </RegExp>

      <expression noclean="1" />
    </RegExp>
  </GetDetails>

</scraper>
